<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPTV Kontrol Paneli - GeliÅŸtirilmiÅŸ Versiyon</title>
    <!-- Gerekli KÃ¼tÃ¼phaneler -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* css stilleri */
    </style>
</head>
<body>
    <!-- Spinner -->
    <div id="spinner" class="spinner-overlay" style="display:none;">
        <div class="spinner"></div>
    </div>
    <div class="glass-panel">
        <!-- BaÅŸlÄ±k -->
        <div class="text-center mb-5">
            <h1 class="display-5 fw-bold mb-3" style="color: var(--primary);">
                ðŸ“º IPTV OynatÄ±cÄ± ve Kontrol
            </h1>
            <p class="lead" style="color: var(--text-secondary);">
                Profesyonel IPTV BaÄŸlantÄ± YÃ¶netim Paneli
            </p>
        </div>
        <!-- IPTV Kanal OynatÄ±cÄ± BÃ¶lÃ¼mÃ¼ -->
        <div class="row mb-4">
            <!-- Sol: Video OynatÄ±cÄ± -->
            <div class="col-md-8">
                <div class="video-player-section">
                    <video id="videoPlayer" controls playsinline webkit-playsinline style="width: 100%; max-height: 400px; background: black;">
                        TarayÄ±cÄ±nÄ±z video etiketini desteklemiyor.
                    </video>
                </div>
                <div id="currentChannel">Åžu anda oynatÄ±lan kanal: Yok</div>
                <div class="input-group mb-3">
                    <span class="input-group-text">Link</span>
                    <input type="text" id="currentLink" class="form-control" placeholder="Kanal linki buraya yÃ¼klenecek">
                    <button class="btn btn-primary" id="applyLinkBtn" type="button">Uygula</button>
                </div>
            </div>
            <!-- SaÄŸ: M3U URL GiriÅŸi, Kanal Listesi ve Arama -->
            <div class="col-md-4">
                <div class="mb-3 d-flex align-items-center gap-2">
                    <input type="text" id="m3uUrl" class="form-control input-field" value="https://raw.githubusercontent.com/GitLatte/patr0n/refs/heads/site/lists/iptvsevenler.m3u">
                    <label class="btn gradient-btn" style="padding: 6px 12px;">
                        Dosya SeÃ§
                        <input type="file" id="m3uFile" accept=".m3u" style="display: none;">
                    </label>
                </div>
                <div class="mb-3 d-flex align-items-center gap-2">
                    <button class="btn gradient-btn kanal-btn" id="loadChannelsBtn">KanallarÄ± YÃ¼kle</button>
                    <button class="btn gradient-btn vavoo-btn" id="loadVavooBtn">Vavoo</button>
                    <input type="text" id="channelSearch" class="form-control" style="max-width: 180px;" placeholder="Kanal Ara">
                </div>
                <!-- Kanal listesi -->
                <div id="channelList" class="list-group flex-grow-1"></div>
            </div>
        </div>
        <!-- BaÄŸlantÄ± Listesi -->
        <div class="mb-4">
            <label class="form-label mb-3" style="color: var(--text-primary); font-weight: 600;">BaÄŸlantÄ± Listesi</label>
            <textarea id="contenido" class="form-control input-field" rows="6" placeholder="Ã–rnek: http://48.magnm.win:8080/live/P8HTV54/rt9oonpZro/136594.m3u8" style="resize: none;">https://raw.githubusercontent.com/patr0nq/link/refs/heads/main/fullLink.txt</textarea>
        </div>
        <!-- Kontrol ButonlarÄ± ve BaÅŸlangÄ±Ã§ Ä°ndeksi -->
        <div class="d-flex flex-wrap justify-content-between gap-3 mb-5">
            <div class="d-flex flex-wrap gap-3">
                <button class="btn gradient-btn" id="clearBtn" style="background: linear-gradient(45deg, #ef4444, #dc2626);">
                    <i class="fas fa-eraser me-2"></i>Temizle
                </button>
                <button class="btn gradient-btn" id="downloadBtn" style="background: linear-gradient(45deg, #3b82f6, #2563eb);" disabled>
                    <i class="fas fa-download me-2"></i>Ä°ndir
                </button>
            </div>
            <div class="d-flex flex-wrap gap-3">
                <input type="number" id="startIndex" class="form-control" placeholder="BaÅŸlangÄ±Ã§ indeksi (Ã¶r: 500)" min="1">
                <button class="btn gradient-btn" id="startScanBtn" style="background: linear-gradient(45deg, #22c55e, #16a34a);">
                    <i class="fas fa-play me-2"></i>Kontrol Et
                </button>
                <button id="toggleScanBtn" class="btn gradient-btn" style="background: linear-gradient(45deg, #f59e0b, #d97706);">
                    Durdur
                </button>
            </div>
        </div>
        <!-- Ä°lerleme BÃ¶lÃ¼mÃ¼ -->
        <div id="progressSection" class="d-none mb-4">
            <div class="d-flex justify-content-between mb-3">
                <span id="indicator" style="color: var(--text-primary); font-weight: 500;">Ä°ÅŸlem BaÅŸlatÄ±lÄ±yor...</span>
                <span id="progressText" style="color: var(--primary); font-weight: 600;">0%</span>
            </div>
            <div class="progress" style="height: 10px; border-radius: 5px; background: rgba(255,255,255,0.1);">
                <div id="progressBar" class="progress-bar progress-bar-striped bg-primary" style="width: 0%; transition: width 0.4s ease;"></div>
            </div>
        </div>
        <!-- Tablo -->
        <div class="table-responsive rounded-3" style="border: 1px solid rgba(255,255,255,0.1);">
            <table class="table modern-table table-hover align-middle" id="sortTable">
                <thead>
                    <tr>
                        <th>Sunucu</th>
                        <th>KullanÄ±cÄ±</th>
                        <th>Son Kullanma</th>
                        <th>Durum</th>
                        <th>Ä°Ã§erikler</th>
                        <th>Ä°ÅŸlem</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    <!-- Toast Bildirim -->
    <div class="toast-container">
        <div id="liveToast" class="toast toast-modern" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-body d-flex align-items-center gap-3">
                <i class="fas"></i>
                <div>
                    <span id="toastMessage" style="color: var(--text-primary);"></span>
                </div>
            </div>
        </div>
    </div>
    <!-- Gerekli JS KÃ¼tÃ¼phaneleri -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script>
        // Verileri depolamak iÃ§in bir liste oluÅŸturun
        let channels = [];

        // proxy URL
        const proxyUrl = 'https://wproxy.net';

        // Sunucudan kanallarÄ± alarak listeleyin
        async function loadChannels() {
            try {
                const response = await axios.get(proxyUrl + '/proxy.php/https://vavoo.to/channels');
                const data = response.data;
                // KanallarÄ±Parsing ediyoruz
                channels = parseChannels(data);
                // Listeleyin
                renderChannelList(channels);
            } catch (error) {
                console.error('KanallarÄ± yÃ¼klerken hata oluÅŸtu:', error);
            }
        }

        // KanallarÄ±-parse ediyoruz
        function parseChannels(data) {
            const channels = [];
            // snapping DÃ¼zeni
            const lines = data.split('\n');
            for (const line of lines) {
                if (line.startsWith('#EXTINF:')) {
                    const parts = line.split(',');
                    const channelName = parts[1].trim();
                    const channelId = parts[0].split(':')[1].trim();
                    channels.push({ id: channelId, name: channelName });
                }
            }
            return channels;
        }

        // Kanal listesini DocumentFragment ile render ediyoruz
        function renderChannelList(channels) {
            const channelListDiv = document.getElementById('channelList');
            channelListDiv.innerHTML = '';
            const fragment = document.createDocumentFragment();
            for (const channel of channels) {
                const channelItem = document.createElement('a');
                channelItem.className = 'list-group-item list-group-item-action channel-item';
                channelItem.href = '#';
                channelItem.textContent = channel.name;
                channelItem.addEventListener('click', async () => {
                    // KanalÄ± aÃ§Ä±yoruz
                    await playChannel(channel.id);
                });
                fragment.appendChild(channelItem);
            }
            channelListDiv.appendChild(fragment);
        }

        // KanalÄ± aÃ§Ä±yoruz
        async function playChannel(channelId) {
            try {
                const url = `https://sv1.wproxy.info/proxy.php/https://vavoo.to/${channelId}/index.m3u8`;
                const videoPlayer = document.getElementById('videoPlayer');
                videoPlayer.src = url;
                videoPlayer.load();
                videoPlayer.play();
            } catch (error) {
                console.error('KanalÄ± aÃ§arken hata oluÅŸtu:', error);
            }
        }

        // Vavoo butonuna tÄ±klandÄ±ÄŸÄ±nda
        document.getElementById('loadVavooBtn').addEventListener('click', loadChannels);
    </script>
</body>
</html>